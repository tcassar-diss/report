\section*{Abstract}

% XXX: this citation actually doesn't really work...
%  optimus says filters are too permissive because generation is bad
%  would make sense that static analysis of the same overestimation would affect 
%  addrfilter less badly than seccomp (same abs, smaller percentage) but this
%  is future work


System call filtering is a security technique to restrict process
privileges. It is widespread, found in container runtimes 
\cite{docker_seccomp}, desktops \cite{chromium_sandboxing,
firefox_seccomp}, and mobile systems \cite{android_seccomp_oreo} which
restricts process privileges. Current
production systems apply a single coarse-grained policy to
an entire application, making them too permissive and therefore suboptimal
\cite{OPTIMUS}. 
We propose \af: a novel, fine-grained, \textit{spatial} system call filter
written in \ac{bpf}. \af is able to filter system calls based on  where in
the process's \ac{vma}, the system call was issued, thereby respecting the 
\ac{polp}\cite{SALTZER_SCHROEDER}. Like this, we are able to use smaller, 
more precise static filters based on code regions within the process's \ac{vma}.
Security and performance evaluation of \af shows a median
privilege
reduction of 52.6\% compared to seccomp, and a median throughput reduction
of 16\%, although we note that some benchmarks exhibited no significant
slowdown. We used the \ac{ltp} system call test suite to validate our
implementation, as well as performing manual verification on carefully
selected examples.

\af demonstrates that spatial system call filtering offers a promising
approach to significantly enhancing security beyond traditional methods, albeit
with a performance trade-off that varies by workload.

\clearpage

\section*{Declaration}

No portion of the work referred to in this report has been
submitted in support of an application for another degree or
qualification of this or any other university or other institute
of learning.

\clearpage

\section*{Copyright}

\begin{enumerate}
    \item The author of this thesis (including any appendices and/or schedules to this thesis) owns certain copyright or related rights in it (the “Copyright”) and s/he has given The University of Manchester certain rights to use such Copyright, including for administrative purposes.

    \item Copies of this thesis, either in full or in extracts and whether in
    hard or electronic copy, may be made \texttt{only} in accordance with the Copyright, Designs and Patents Act 1988 (as amended) and regulations issued under it or, where appropriate, in accordance with licensing agreements which the University has from time to time. This page must form part of any such copies made.

    \item The ownership of certain Copyright, patents, designs, trade marks and other intellectual property (the “Intellectual Property”) and any reproductions of copyright works in the thesis, for example graphs and tables (“Reproductions”), which may be described in this thesis, may not be owned by the author and may be owned by third parties. Such Intellectual Property and Reproductions cannot and must not be made available for use without the prior written permission of the owner(s) of the relevant Intellectual Property and/or Reproductions.

    \item Further information on the conditions under which disclosure,
        publication and commercialisation of this thesis, the Copyright and any
        Intellectual Property and/or Reproductions described in it may take
        place is available in the University IP Policy (see
        \href{http://documents.manchester.ac.uk/DocuInfo.aspx?DocID=24420}{\url{http://documents.manchester.ac.uk/DocuInfo.aspx?DocID=24420}}),
        in any relevant Thesis restriction declarations deposited in the
        University Library, The University Library’s regulations (see
        \href{http://www.library.manchester.ac.uk/about/regulations/}{\url{http://www.library.manchester.ac.uk/about/regulations/}}) and in The University’s policy on presentation of Theses
\end{enumerate}

\clearpage

\section*{Acknowledgements}

I would like to thank my supervisor, Pierre Olivier, for all of his support
throughout this project. He was always available to answer any questions, gave
invaluable guidance, and shared relevant research with me as he stumbled across
it in the wild. 

\clearpage

\tableofcontents

\clearpage

\printacronyms[name=Acronyms and Abbreviations]

\clearpage

\listoffigures

\clearpage

\listoftables

\clearpage

\listoflistings
