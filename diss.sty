\ProvidesPackage{diss}

\usepackage{import}
\usepackage{amsmath}
\usepackage[a4paper, total={5in, 8in}]{geometry}
\usepackage{graphicx} 
\usepackage{acro}

\usepackage[hyphens]{url}
\urlstyle{same}

\usepackage[parfill]{parskip}
\usepackage{caption}
\usepackage{titling}
\renewcommand\maketitlehooka{\vspace*{0.15\textheight}} 
\renewcommand\maketitlehookd{\vfill\null}
\usepackage{array}

\usepackage{biblatex}
\addbibresource{main.bib}

\usepackage[hidelinks]{hyperref}
\usepackage{adjustbox}
\usepackage[dvipsnames]{xcolor}

\usepackage{caption}
\usepackage{minted}

% TODO: add figure/table showing that all syscalls are actually made from libc.
\usepackage{listings}
\usepackage{todonotes}
\usepackage{mathptmx}
\usepackage{marginnote}
\usepackage{booktabs}
\let\marginpar\marginnote
\usepackage{multicol}
\usepackage{float}
\definecolor{deepnavy}{RGB}{59, 40, 150}
\definecolor{mutedsage}{RGB}{25, 114, 120}
\definecolor{warmterracotta}{RGB}{193, 41, 46}

\usepackage[english]{babel}
\usepackage{setspace}
\usepackage{etoolbox}
\AtBeginEnvironment{quote}{\par\singlespacing\small}

\let\oldphi\phi
\renewcommand{\phi}{\varphi}

\let\oldepsilon\epsilon
\renewcommand{\epsilon}{\varepsilon}

\newenvironment{Figure}
  {\par\medskip\noindent\minipage{\linewidth}}
  {\endminipage\par\medskip}

\hypersetup{
    colorlinks=true,
    linkcolor=deepnavy,
    citecolor=mutedsage,
    urlcolor=warmterracotta,
}

\hypersetup{breaklinks=true}

\addtolength{\oddsidemargin}{-0.4in}
\addtolength{\evensidemargin}{-0.4in}
\addtolength{\textwidth}{0.8in}
\addtolength{\topmargin}{-.5in}
\addtolength{\textheight}{1.0in}

% FIXME: spaces shouldn't be included in commands
%   also shouldn't need to define a genitive: figure out how to do
%   properly!
\newcommand{\af}{\texttt{addrfilter }}
\newcommand{\afgen}{\texttt{addrfilter }}
\newcommand{\afss}{\texttt{addrfilter}}
\newcommand{\afg}{\texttt{addrfilter}'s{ }}
%
% \usemintedstyle{friendly}       
% \newminted[pscode]{c}{}
%   fontsize=\small,
%   frame=single,
%   linenos,
%   keywordstyle=\color{blue},
%   commentstyle=\color{gray}\itshape,
%   identifierstyle=\color{black},
% }

% Acronyms and abbreviations
\NewAcroCommand\acg{m}{\acropossessive\UseAcroTemplate{first}{#1}}
\NewAcroCommand\acsg{m}{\acropossessive\UseAcroTemplate{short}{#1}}
\NewAcroCommand\aclg{m}{\acropossessive\UseAcroTemplate{long}{#1}}

\NewAcroCommand\acfg{m}{
    \acrofull
    \acropossessive
    \UseAcroTemplate{first}{#1}
}

\NewAcroCommand\iacsg{m}{
    \acroindefinite
    \acropossessive
    \UseAcroTemplate{short}{#1}
}

\DeclareAcroEnding{possessive}{'s}{'s}


\DeclareAcronym{API}{
    short=API,
    long=Application Programming Interface,
}

\DeclareAcronym{CPU}{
    short=CPU,
    long=Central Processing Unit,
}

\DeclareAcronym{bpf}{
    short=eBPF,
    long= The Extended Berkley Packet Filter,
    short-indefinite = an
}

\DeclareAcronym{I/O}{
    short = I/O,
    long = Input/Output,
}

\DeclareAcronym{OS}{ 
    short = OS,
    long = Operating System,
}

\DeclareAcronym{syscall}{
    short = syscall,
    long = System Call,
}

\DeclareAcronym{xdp}{
    short = XDP,
    long = Express Data Path
}

\DeclareAcronym{lsm}{
    short = LSMs,
    long = Linux Security Modules
}

\DeclareAcronym{toctou} {
    short=TOCTOU,
    long = {Time of Check, Time of Use}
}

\DeclareAcronym{vma} {
    short={VMA},
    long=Virtual Memory Area
}

\DeclareAcronym{fa} {
    short={FA},
    long=Filtered Application
}

\DeclareAcronym{aslr} {
    short = ASLR,
    long = Address Space Layout Randomisation
}

\DeclareAcronym{k8s} {
    short = k8s,
    long = Kubernetes
}

\DeclareAcronym{pc}{
    short = PC,
    long = Program Counter
}


\DeclareAcronym{ltp} {
    short = LTP,
    long = Linux Test Project
}

\DeclareAcronym{npb} {
    short = NPB,
    long = NASA Parallel Benchmark,
    short-indefinite = an
}

\DeclareAcronym{ta} {
    short = TA,
    long = Threat Actor
}

\DeclareAcronym{rce} {
    short = RCE,
    long = Remote Code Execution,
    short-indefinite = an
}

\DeclareAcronym{libc} {
    short = \texttt{libc},
    long = The C Standard Library,
}

\DeclareAcronym{pid} {
    short = PID,
    long = Process ID,
}

\DeclareAcronym{toml} {
    short = TOML,
    long = Tom's Ordinary Markup Language
}
