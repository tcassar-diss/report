\ProvidesPackage{diss}
\UseRawInputEncoding
\usepackage{booktabs}
\usepackage{import}
\usepackage{amsmath}
\usepackage[a4paper, total={5in, 8in}]{geometry}
\usepackage{graphicx} 
\usepackage{acro}

\usepackage[hyphens]{xurl}
\urlstyle{same}

\usepackage[parfill]{parskip}
\usepackage{titling}
\renewcommand\maketitlehooka{\vspace*{0.15\textheight}} 
\renewcommand\maketitlehookd{\vfill\null}
\usepackage{array}

\usepackage[backend=bibtex,bibencoding=ascii,url=true,hyperref=true]{biblatex}
\AtBeginBibliography{\sloppy}
\addbibresource{main.bib}

\usepackage[hidelinks,breaklinks]{hyperref}
\usepackage{adjustbox}
\usepackage[dvipsnames]{xcolor}

\usepackage{listings}
% \renewcommand{\listingscaption}{Code}
% \renewcommand{\listoflistingscaption}{List of Code Examples}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}
\usepackage[T1]{fontenc}
\usepackage{caption}
\usepackage{minted}
\usepackage{todonotes}
\usepackage{mathptmx}
\usepackage{marginnote}
\usepackage{booktabs}
\let\marginpar\marginnote
\usepackage{multicol}
\usepackage{float}
\usepackage{subcaption}
\definecolor{deepnavy}{RGB}{59, 40, 150}
\definecolor{mutedsage}{RGB}{25, 114, 120}
\definecolor{warmterracotta}{RGB}{193, 41, 46}
\usepackage{siunitx}
\usepackage[english]{babel}
\usepackage{setspace}
\usepackage{etoolbox}
\AtBeginEnvironment{quote}{\par\singlespacing\small}

% make text machine searchable
\pdfgentounicode=1

\let\oldphi\phi
\renewcommand{\phi}{\varphi}

\let\oldepsilon\epsilon
\renewcommand{\epsilon}{\varepsilon}

\newenvironment{Figure}
  {\par\medskip\noindent\minipage{\linewidth}}
  {\endminipage\par\medskip}

\hypersetup{
    colorlinks=true,
    linkcolor=deepnavy,
    citecolor=mutedsage,
    urlcolor=warmterracotta,
}

\usepackage{tikz}
\tikzset{
  tech/.style={
    draw,
    rectangle,
    rounded corners,
    minimum width=3cm,
    minimum height=1cm,
    align=center,
    font=\sffamily
  },
  box/.style={
    draw,
    rounded corners,
    align=center,
    minimum width=3.5cm,
    minimum height=1cm,
    font=\small
  },
  arr/.style={
    -{Latex[length=3mm]},
    semithick
  }
}
\usetikzlibrary{ positioning, arrows.meta, calc, shapes.geometric, shadows,
decorations.pathreplacing, calligraphy, shapes.symbols}


\usepackage[hyphens]{url}

% Optional: Configure listing style globally
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    keepspaces=true,
    numbers=left,
    numbersep=5pt,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=2,
    language=C % Set default language to C
}
\lstset{style=mystyle} % Apply the global style

\addtolength{\oddsidemargin}{-0.4in}
\addtolength{\evensidemargin}{-0.4in}
\addtolength{\textwidth}{0.8in}
\addtolength{\topmargin}{-.5in}
\addtolength{\textheight}{1.0in}

\usepackage{xspace}
\newcommand{\af}{\texttt{addrfilter}\xspace}

% XXX: Left in for backwards compatibility
\newcommand{\afgen}{\texttt{addrfilter generate}\xspace}
\newcommand{\afss}{\texttt{addrfilter}}
\newcommand{\afg}{\texttt{addrfilter}'s\xspace}
%
% \usemintedstyle{friendly}       
% \newminted[pscode]{c}{}
%   fontsize=\small,
%   frame=single,
%   linenos,
%   keywordstyle=\color{blue},
%   commentstyle=\color{gray}\itshape,
%   identifierstyle=\color{black},
% }

% Acronyms and abbreviations
\NewAcroCommand\acg{m}{\acropossessive\UseAcroTemplate{first}{#1}}
\NewAcroCommand\acsg{m}{\acropossessive\UseAcroTemplate{short}{#1}}
\NewAcroCommand\aclg{m}{\acropossessive\UseAcroTemplate{long}{#1}}

\NewAcroCommand\acfg{m}{
    \acrofull
    \acropossessive
    \UseAcroTemplate{first}{#1}
}

\NewAcroCommand\iacsg{m}{
    \acroindefinite
    \acropossessive
    \UseAcroTemplate{short}{#1}
}

\DeclareAcroEnding{possessive}{'s}{'s}




\DeclareAcronym{api}{
    short=API,
    long=Application Programming Interface,
}

\DeclareAcronym{cpu}{
    short=CPU,
    long=Central Processing Unit,
}

\DeclareAcronym{bpf}{
    short=eBPF,
    long= Extended Berkley Packet Filter,
    short-indefinite = an
}

\DeclareAcronym{io}{
    short = I/O,
    long = Input/Output,
}

\DeclareAcronym{os}{ 
    short = OS,
    long = Operating System,
}

\DeclareAcronym{xdp}{
    short = XDP,
    long = Express Data Path
}

\DeclareAcronym{lsm}{
    short = LSMs,
    long = Linux Security Modules
}

\DeclareAcronym{toctou} {
    short=TOCTOU,
    long = {Time of Check, Time of Use}
}

\DeclareAcronym{vma} {
    short={VMA},
    long=Virtual Memory Area
}

\DeclareAcronym{fa} {
    short={FA},
    long=Filtered Application
}

\DeclareAcronym{aslr} {
    short = ASLR,
    long = Address Space Layout Randomisation
}

\DeclareAcronym{k8s} {
    short = k8s,
    long = Kubernetes
}

\DeclareAcronym{pc}{
    short = PC,
    long = Program Counter
}


\DeclareAcronym{ltp} {
    short = LTP,
    long = Linux Test Project
}

\DeclareAcronym{npb} {
    short = NPB,
    long = NASA Parallel Benchmark,
    short-indefinite = an
}

\DeclareAcronym{ta} {
    short = TA,
    long = Threat Actor
}

\DeclareAcronym{rce} {
    short = RCE,
    long = Remote Code Execution,
    short-indefinite = an
}

\DeclareAcronym{libc} {
    short = \texttt{libc},
    long = The C Standard Library,
}

\DeclareAcronym{pid} {
    short = PID,
    long = Process ID,
}

\DeclareAcronym{core}{
    short = {CO-RE},
    long = {Compile Once, Run Anywhere}
}

\DeclareAcronym{btf} {
    short = BTF,
    long = BPF Type Format
}

\DeclareAcronym{stdout} {
    short = \texttt{stdout},
    long = Standard Output
}

\DeclareAcronym{loc} {
    short = LoC,
    long = Lines of Code
}

\DeclareAcronym{cli} {
    short = CLI,
    long = Command Line Interface
}

\DeclareAcronym{polp}{
    short = PoLP,
    long = Principle of Least Privilege
}

\DeclareAcronym{pie}{
    short = PIE,
    long = Position Independent Executable
}

\DeclareAcronym{uid}{
    short = UID,
    long = User ID
}

\DeclareAcronym{gid}{
    short = GID,
    long = Group ID
}

\DeclareAcronym{ipc}{
    short = IPC,
    long = Inter Process Communication,
    short-indefinite = an,
}

\DeclareAcronym{elf}{
    short = ELF,
    long = Executable and Linkable Format
}

\DeclareAcronym{rop} {
    short = ROP,
    long = Return Oriented Programming
}

\DeclareAcronym{isa}{
    short = ISA,
    long = Instruction Set Architecture,
    short-indefinite = an
}

\DeclareAcronym{mpk} {
    short = MPK,
    long = Memory Protection Key,
    short-indefinite = an,
}

\DeclareAcronym{pku} {
    short = PKU,
    long = Protection Key for Userspace,
    long-plural = Protection Keys for Userspace,
}

\DeclareAcronym{iqr}{
    short = IQR,
    long = Inter-Quartile Range,
    short-indefinite = an
}
